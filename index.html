<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Report Entry - CleanSriLanka</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Diagnostics banner -->
    <div id="diagnostics" style="width:100%;text-align:center;padding:6px 0;font-weight:bold;display:none;"></div>
    <!-- Top-left Home button -->
    <button id="top-home-btn" class="top-home" title="Home" aria-label="Home">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 9.5L12 3l9 6.5" />
        <path d="M9 22V12h6v10" />
      </svg>
    </button>
    <main class="container">
      <div style="display:flex;align-items:center;justify-content:center;gap:24px;margin-bottom:0.2em;">
        <img src="images/statelogo.png" alt="Left Logo" class="logo-img" />
        <div>
          <h2 style="text-align:center;font-size:2.2em;color:#2b7a78;margin-bottom:0.2em;font-weight:bold;margin:0;">සතුටු රටක් Clean Sri Lanka ගමින් ගමට</h2>
          <div style="text-align:center;font-size:1.3em;color:#205072;margin-bottom:1em;">වැලිගම ප්‍රාදේශීය ලේකම් කාර්යාලය</div>
        </div>
        <img src="images/csllogo.png" alt="Right Logo" class="logo-img" />
      </div>
   

      <section class="card" id="home-card">
        <h2>Summary</h2>
        <div id="dashboard-stats" style="display:flex;justify-content:center;gap:32px;margin-bottom:18px;text-align:center;font-size:1.1em;"></div>
        <div class="chart-wrap">
          <canvas id="summaryChart" width="400" height="180"></canvas>
        </div>
        <div class="home-actions" style="display:flex;justify-content:center;gap:20px;margin-top:24px;">
          <button id="goto-insert" class="big">Insert Data</button>
          <button id="goto-search" class="big">Search Data</button>
        </div>
      </section>

      <section id="insert-card" class="card">
        <h2>New Report</h2>
        <form id="entry-form">
          <label>Token No <span class="req">*</span><input type="text" id="token" required /></label>
          <label>NIC<input type="text" id="nic" /></label>
          <label>Phone No<input type="text" id="phone" /></label>
          <label>Name <span class="req">*</span><input type="text" id="name" required /></label>
          <label>Address <span class="req">*</span><textarea id="address" rows="2" required></textarea></label>
          <label>Problem <span class="req">*</span><textarea id="problem" rows="3" required></textarea></label>
          <div class="actions">
            <button type="submit">Submit Report</button>
            <span id="entry-status" class="status"></span>
          </div>
        </form>
      </section>

      <section id="search-card" class="card">
        <h2>Search Reports</h2>
        <div class="search-row">
          <input id="search-input" placeholder="Search by NIC, phone or name" />
          <div style="display:flex;gap:8px;align-items:center">
            <button id="search-btn">Search</button>
          </div>
        </div>
        <ul id="results"></ul>
      </section>

      <section class="card" id="detail-card" style="display:none;">
        <h2>Report Detail</h2>
        <div id="detail"></div>

        <form id="update-form">
          <label>Status
            <select id="status">
              <option value="">-- choose --</option>
              <option value="solved">Solved</option>
              <option value="not solved">Not Solved</option>
            </select>
          </label>
          <label>Note<textarea id="note" rows="3"></textarea></label>
          <div class="actions">
            <button type="submit">Submit Update</button>
            <span id="update-status" class="status"></span>
          </div>
        </form>
      </section>
    </main>

    <!-- Supabase JS client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <!-- Chart.js for summary graph -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- User-supplied config (edit with your keys) -->
    <script src="config.js"></script>
    <script src="script.js"></script>
    <footer style="width:100%;text-align:center;padding:16px 0 8px 0;color:#205072;font-size:1em;background:#f7f7f7;margin-top:32px;">
      &copy; Copyright Divisional Secretariat Weligama
    </footer>
  </body>
</html>
